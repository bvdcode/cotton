/**
 * Auto-hide controls in media lightbox gallery
 * 
 * Architecture:
 * - Controls fade out after 2.5s of inactivity
 * - Smoothly reappear on any user interaction (move, click, scroll, touch)
 * - Cursor also hides for immersive viewing experience
 * 
 * Implementation:
 * - useActivityDetection hook tracks user activity
 * - CSS classes control visibility with smooth transitions
 * - Works with all YARL plugins (zoom, video, thumbnails, etc.)
 */

/* Base state: controls visible with smooth transitions */
.lightbox-autohide .yarl__toolbar,
.lightbox-autohide .yarl__navigation_prev,
.lightbox-autohide .yarl__navigation_next,
.lightbox-autohide .media-lightbox__header,
.lightbox-autohide .yarl__slide_description_container {
  opacity: 1;
  pointer-events: auto;
  transition: opacity 0.3s ease-in-out;
}

/* Video slides have vertical padding to prevent controls overlap */
.lightbox-autohide .yarl__slide video {
  padding: 0;
  box-sizing: border-box;
}

/* Edge-to-edge slides: avoid built-in carousel/slide paddings */
.lightbox-autohide .yarl__slide {
  padding: 0;
}

/* Idle state: controls hidden */
.lightbox-autohide--idle .yarl__toolbar,
.lightbox-autohide--idle .yarl__navigation_prev,
.lightbox-autohide--idle .yarl__navigation_next,
.lightbox-autohide--idle .media-lightbox__header,
.lightbox-autohide--idle .yarl__slide_description_container {
  opacity: 0;
  pointer-events: none;
}

/* Keep cursor visible when active */
.lightbox-autohide {
  cursor: default;
}

/* Hide cursor when idle for immersive viewing */
.lightbox-autohide--idle {
  cursor: none;
}

/* Move media metadata (counter • size • name) to the top-left. */
.lightbox-autohide .media-lightbox__header {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: auto;

  /* Match YARL toolbar placement (top-right) */
  padding: var(--yarl__toolbar_padding, 16px);
  height: calc(
    var(--yarl__icon_size, 32px) + 2 * var(--yarl__toolbar_padding, 8px)
  );
  display: flex;
  align-items: center;
  box-sizing: border-box;

  /* Leave space for the toolbar buttons on the right */
  padding-right: calc(var(--yarl__toolbar_padding, 8px) + 111);
  pointer-events: none;
  z-index: 1;
  text-align: left;

  font-weight: 500;
  font-size: 0.95rem;
  line-height: 1.2;

  /* Keep title on a single line and truncate if too long */
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.lightbox-autohide .media-lightbox__counter,
.lightbox-autohide .media-lightbox__meta,
.lightbox-autohide .media-lightbox__name,
.lightbox-autohide .media-lightbox__size {
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.lightbox-autohide .media-lightbox__meta {
  min-width: 0;
  display: inline-flex;
  align-items: center;
}

.lightbox-autohide .media-lightbox__sep {
  margin: 0 8px;
  flex: 0 0 auto;
}

/* Ensure inner title text truncates cleanly (selector tolerant if class exists) */
.lightbox-autohide .yarl__slide_title_container .yarl__slide_title {
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

/* Mobile: keep only the counter */
@media (max-width: 600px) {
  .lightbox-autohide .media-lightbox__meta {
    display: none;
  }
}

@media (max-width: 900px) {
  .lightbox-autohide .media-lightbox__header {
    padding-right: calc(var(--yarl__toolbar_padding, 8px) + 180px);
  }
}

.lightbox-autohide .yarl__slide_description_container {
  display: none;
}

/* ===== Hover-to-reveal thumbnail overlay ===== */

/*
 * Take thumbnails out of document flow so slides fill the full viewport.
 * The strip floats on top of the photo near the bottom edge.
 */
.lightbox-autohide .yarl__thumbnails_container {
  position: absolute !important;
  bottom: 0;
  left: 0;
  right: 0;
  z-index: 10;
  height: auto !important;
  flex: none !important;
  background: transparent;
  transition: background 0.3s ease;
}

/* Extra hover trigger zone above the thumbnail strip */
.lightbox-autohide .yarl__thumbnails_container::before {
  content: "";
  position: absolute;
  bottom: 100%;
  left: 0;
  right: 0;
  height: 40px;
}

/* Track hidden by default */
.lightbox-autohide .yarl__thumbnails_track {
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.3s ease;
}

/* Remove built-in vignette shadow, we apply our own gradient */
.lightbox-autohide .yarl__thumbnails_vignette {
  background: none !important;
}

/* Desktop with pointer: reveal on hover */
@media (hover: hover) and (pointer: fine) {
  .lightbox-autohide .yarl__thumbnails_container:hover {
    background: linear-gradient(transparent, rgba(0, 0, 0, 0.55));
  }

  .lightbox-autohide .yarl__thumbnails_container:hover .yarl__thumbnails_track {
    opacity: 1;
    pointer-events: auto;
  }
}

/* Touch / mobile: hide thumbnails entirely */
@media (hover: none) {
  .lightbox-autohide .yarl__thumbnails_container {
    display: none !important;
  }
}
